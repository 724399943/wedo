<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title><block name="title">{:C('systemName')}</block><block name="suffix"></block></title>
    <meta name="renderer" content="webkit">
    <meta name="description" content="<block name="description"></block>">
    <meta name="keywords" content="<block name="keywords"></block>">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <link rel="shortcut icon" href="__PUBLIC__/xcrozz.ico" type="image/x-icon">
    <link href="__PUBLIC__/Shop/css/base.css" rel="stylesheet">
    <link href="__PUBLIC__/Shop/css/style.css" rel="stylesheet">
    <script src="__PUBLIC__/Wechat/js/jquery-1.8.3.min.js" type="text/javascript"></script>
    <link href="__PUBLIC__/Shop/css/login.css" rel="stylesheet">
    <style type="text/css">
        body{background: #fff;}
    </style>
</head>
<div class="login-box">
    <div class="l-top">
        <a href="/" class="logo">
            <img src="__PUBLIC__/Shop/images/okshop_logo.png" width="134" alt="">
        </a>
    </div>
    <div class="box clearfix">
        <img src="__PUBLIC__/Shop/images/loginpic.jpg" alt="" class="pic">
        <div class="login-input-b">
            <div class="login-data login-sigin-data">
                <div class="tit">
                    {$Think.lang._PC_LOGIN_SIGN_UP_WEDO_MERCHANT_}
                    <span class="fl">{$Think.lang._PC_LOGIN_ALREADY_AS_A_MEMBER_}<a href="{:U('Login/login')}">{$Think.lang._PC_LOGIN_TO_LOG_IN_}</a></span>
                </div>
                <form id="Jform">
                    <div class="in-box">
                        <em class="ico"></em>
                        <input placeholder="{$Think.lang._COMMON_PLEASE_ENTER_}{$Think.lang._WAP_REGISTER_EMAILADDRESS_}" type="text" class="text" name="email" id="Jphone">
                        <span class="true"></span>
                    </div>
                    <div class="in-box">
                        <em class="ico pas"></em>
                        <input id="password" name="password" placeholder="{$Think.lang._PC_LOGIN_ENTER_PASSWORD_}" type="password" class="text">
                        <div class="pass-power">
                            {$Think.lang._PC_LOGIN_SAFETY_LOAD_}
                            <span class="r Jone">{$Think.lang._PC_LOGIN_SAFETY_WARK_}</span>
                            <span class='m Jtwo'>{$Think.lang._PC_LOGIN_SAFETY_MIDDLE_}</span>
                            <span class='s Jthree'>{$Think.lang._PC_LOGIN_SAFETY_STRONG_}</span>
                        </div>
                    </div>
                    <div class="in-box">
                        <em class="ico pas"></em>
                        <input placeholder="{$Think.lang._PC_LOGIN_CONFIRM_PASSWORD_}" type="password" class="text" name="repassword" id="repassword">
                    </div>
                    <div class="in-yan" style="display: block">
                        <span class="adreess" style="margin-left: 40px; float: left;"></span>
                        <input type="text" class="text" name="verify" id="JverifyCode" value=""  placeholder="{$Think.lang._WAP_REGISTER_VERIFY_}">
                        <a href="javascript:;"  class="btn" id="Jverify" style="border-radius: 25px;">{$Think.lang._PC_LOGIN_GET_VERIFICATION_CODE_}</a>
                        <em class="key"></em>
                    </div>
                    <div class="in-box">
                        <input placeholder="{$Think.lang._COMMON_PLEASE_ENTER_}{$Think.lang._WAP_REGISTER_PHONENUMBER_}" type="text" class="text" name="phone">
                        <span class="true"></span>
                    </div>
                    <div class="in-box">
                        <input placeholder="{$Think.lang._PC_LOGIN_REFERRALS_}" type="text" class="text" name="referrer">
                        <span class="true"></span>
                    </div>
                    <div class="in-txt">
                        <label class="lab">
                            <input type="checkbox" id="Jprotocol" name="" checked value="">         
                            {$Think.lang._PC_LOGIN_HAVE_READ_AND_AGREE_}
                        </label>
                        <a class="xy Jxy" href="javascript:;">{$Think.lang._PC_LOGIN_SERVICE_AGREEMENT_}</a>
                    </div>
                    <input type="hidden" name="status" value="1">
                    <input type="hidden" name="type" value="0" />
                    <input type="hidden" name="sendType" id="JSendType" value="" />
                    <a href="javascript:;" id="Jsbumit" class="conment-login">{$Think.lang._PC_LOGIN_REGISTER_}</a>
                    <a href="javascript:;" style="line-height: 22px;">{$Think.lang._PC_LOGIN_REGISTER_ANY_PROBLEM_}{:C('serviceTel')}</a>
                </form>
            </div>
        </div>
    </div>
</div>
<!--  提示信息 -->
<div class="tips" id="tips">
    <span class="ico"></span>
    <span class="txt">键盘大写锁定已打开，请注意大小写</span> <em></em>
</div>
<!-- okshop协议 -->
<div class="baiyang-agreement">
    <div class="ag-main Jbaiyang-main">
        <div class="a-box">
            <div class="tit">{$Think.lang._PC_LOGIN_USER_AGREEMEND_}</div>
            <div class="data">
                {$article}
            </div>
            <a href="javascript:;" class="com-btn-ture">{$Think.lang._PC_LOGIN_I_AGREE_}</a>
        </div>
    </div>
</div>
<script type="text/javascript" src="__PUBLIC__/Shop/js/passwork.js"></script>
<script type="text/javascript" src="__PUBLIC__/Shop/js/keydown.js"></script>
<script type="text/javascript">
    var getVerifySign = true;

    //错误提示
    function falltips(emlemt, txt) {
        var l = $(emlemt).offset().left;
        var t = $(emlemt).offset().top;
        $('#tips').css({'top':t-44,"left":l-40});
        $('#tips').show();
        $('#tips').find('.txt').html(txt);
    }

    $('.Jxy').click(function(){
       $('.baiyang-agreement').show(); 
    });

    $('.com-btn-ture').click(function(){
        $('.baiyang-agreement').hide(); 
    });

    $('.baiyang-agreement').click(function(){
        var obj  = $(event.target);
        var leng = $('.Jbaiyang-main').find(obj).length;
        if(leng<1){
           $('.baiyang-agreement').hide(); 
        }
    });

    $(function() {
        /*密码强度*/    
        $.passcon("#password", ".Jone", ".Jtwo", ".Jthree"); 

        /*显示获取验证码*/
        $('#repassword').keyup(function(){
            if( $(this).val() == $('#password').val() ){
                $('.in-yan').show();
            }
        });

        $('.in-box .text').on({
            blur:function(event) {
                $(this).parent('.in-box').removeClass('blur-box');
                $(this).siblings('.pass-power').hide();
                $('#tips').hide();
            },
            focus:function(event) {
                $(this).parent('.in-box').addClass('blur-box');
                $(this).siblings('.pass-power').show();
                $('#tips').hide();
            }
        });

        $('.in-yan .text').on({
            blur:function(event) {
                $(this).removeClass('blur-box');
            },
            focus:function(event) {
                $(this).addClass('blur-box');
            }
        });
        
        /*获取验证码*/   
        $('#Jverify').click(function() {
            if ($('#Jphone').val() == '') {
                falltips('#Jphone','{$Think.lang._COMMON_PLEASE_ENTER_}{$Think.lang._WAP_REGISTER_EMAILADDRESS_}');
                return;
            } else if (!isTelephone($('#Jphone').val()) && !isEmail($('#Jphone').val()) ) {
                falltips('#Jphone','{$Think.lang._PC_LOGIN_ENTER_CORRECT_LOG_IN_ID_}');
                return;
            } else if ($('#password').val() == '') {
                falltips('#password','{$Think.lang._PC_LOGIN_ENTER_YOUR_PASSWORD_}');
                return;
            } else if ($('#password').val().length < 6 || $('#password').val().length >20) {
                falltips('#password','{$Think.lang._PC_LOGIN_ENTER_NEW_PASSWORD_}');
                return;
            } else if ($('#password').val() != $('#repassword').val()) {
                falltips('#password','{$Think.lang._PC_LOGIN_PASSWORD_DID_NOT_MATCH_}');
                return;
            }

            if (getVerifySign) {
                getVerifySign = false;
                $.ajax({
                    url: "{:U('Login/getVerifyCode')}",
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        'account' : $('#Jphone').val(),
                        'type' : 0,
                    }
                })
                .done(function(returnData) {
                    if ( returnData['status'] == '200000' ) {
                        // alert(returnData['data']['code']);
                        // $('#JSendType').val(sendType);
                        $('#Jverify').text(60);
                        timer();
                    } else {
                        falltips('#Jphone',returnData['message']);
                        getVerifySign = true;                        
                    }
                }); 
            }
        });

        $('#Jsbumit').click(function() {
            if ($('#Jphone').val() == '') {
                falltips('#Jphone','{$Think.lang._COMMON_PLEASE_ENTER_}{$Think.lang._WAP_REGISTER_EMAILADDRESS_}');
                return;
            } else if (!isTelephone($('#Jphone').val()) && !isEmail($('#Jphone').val()) ) {
                falltips('#Jphone','{$Think.lang._PC_LOGIN_ENTER_CORRECT_LOG_IN_ID_}');
                return;
            } else if ($('#password').val() == '') {
                falltips('#password','{$Think.lang._PC_LOGIN_ENTER_YOUR_PASSWORD_}');
                return;
            } else if ($('#password').val().length < 6 || $('#password').val().length >20) {
                falltips('#password','{$Think.lang._PC_LOGIN_ENTER_NEW_PASSWORD_}');
                return;
            } else if ($('#password').val() != $('#repassword').val()) {
                falltips('#repassword','{$Think.lang._PC_LOGIN_PASSWORD_DID_NOT_MATCH_}');
                return;
            } else if ($('#JverifyCode').val() == '') {
                falltips('.adreess','{$Think.lang._PC_LOGIN_ENTER_VERIFICATION_CODE_}');
                return;
            } else if (!$('#Jprotocol')[0].checked) {
                msgbox('{$Think.lang._PC_LOGIN_HAVE_READ_AND_AGREE_}{$Think.lang._PC_LOGIN_SERVICE_AGREEMENT_}');
                return;
            }

            $.ajax({
                url: "{:U('Login/register')}",
                type: 'POST',
                dataType: 'json',
                data: $('#Jform').serialize()
            })
            .done(function(returnData) {
                if (returnData['status'] == '200000') {
                    window.location.href = "{:U('Agent/completeAgent')}?user_id=" + returnData['data']['userId'];
                }else {
                    falltips('.adreess', returnData['message']);
                }
            });
        });
    });

    function timer() {
        var value = Number($('#Jverify').text()); 
        if (value > 1) {
            document.getElementById("Jverify").innerHTML = value-1;
            //$('#Jverify').text(value - 1);
        } else {
            document.getElementById("Jverify").innerHTML = '{$Think.lang._WAP_REGISTER_REGAINVERIFY_}';
            //$('#Jverify').text('重新获取');
            getVerifySign = true;
            return false;
        }
        window.setTimeout("timer()", 1000); 
    }

    function isTelephone (telephone) {
        var telReg = !!telephone.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[6780]|18[0-9]|14[57])[0-9]{8}$/);
        //如果手机号码不能通过验证
        return telReg;
    }

    /*判断邮箱格式*/
    function isEmail (email) {
        var emailReg = !!email.match(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);
        //如果邮箱不能通过验证
        return emailReg;
    }
</script>